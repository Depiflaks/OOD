classDiagram
    class IState {
        + InsertQuarter()
        + EjectQuarter()
        + TurnCrank()
        + Dispense()
        + ToString() string
    }

    class IGumballMachine {
        + ReleaseBall()
        + GetBallCount() unsigned
        + SetSoldOutState()
        + SetNoQuarterState()
        + SetSoldState()
        + SetHasQuarterState()
    }

    class SoldState {
        - m_gumballMachine: IGumballMachine&
    }

    class SoldOutState {
        - m_gumballMachine: IGumballMachine&
    }

    class HasQuarterState {
        - m_gumballMachine: IGumballMachine&
    }

    class NoQuarterState {
        - m_gumballMachine: IGumballMachine&
    }

    class GumballMachine {
        - m_count: unsigned
        - m_soldState: SoldState
        - m_soldOutState: SoldOutState
        - m_noQuarterState: NoQuarterState
        - m_hasQuarterState: HasQuarterState
        - m_state: IState*
    %% public
        + InsertQuarter()
        + EjectQuarter()
        + TurnCrank()
        + ToString() string
    %% private
        - ReleaseBall()
        - GetBallCount() unsigned
        - SetSoldOutState()
        - SetNoQuarterState()
        - SetSoldState()
        - SetHasQuarterState()
    }

    IState <|.. SoldState
    IState <|.. SoldOutState
    IState <|.. HasQuarterState
    IState <|.. NoQuarterState
    IGumballMachine <|.. GumballMachine
    GumballMachine *--> IState
